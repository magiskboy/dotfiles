#!/usr/bin/env zsh

export ZSH="$HOME/.oh-my-zsh"

plugins=(
  git
  jsontools
  gcloud
  kubectl
  docker
  zsh-autosuggestions
  zsh-z
)

source $ZSH/oh-my-zsh.sh
[ -f ~/.fzf.zsh  ] && source ~/.fzf.zsh

alias genssl="openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout cert.key -out cert.crt"
alias genmacaddr="openssl rand -hex 6 | sed 's/\(..\)/\1:/g;s/.$//'"
alias reload="exec \"$SHELL\""
alias md="mkdir"
[[ $OS = "linux" ]] && alias fd="fdfind"
alias ls="exa"
alias ll="exa --long"
alias lt="exa --tree"
alias preview="[[ -d \$1 ]] && exa -T \$1 || bat \$1"
alias cd="_f() {[[ -z \$@ ]] && {x=\$(FZF_DEFAULT_COMMAND='fd --type d' fzf);[[ \$? -eq 0 ]] && builtin cd \$x || true} || builtin cd \$@ }; _f \$@"
 alias open="_f() {[[ -z \$@ ]] && {x=\$(FZF_DEFAULT_COMMAND='fd' fzf); [[ \$? -eq 0 ]] && command open \$x || true } || { command open \$@ }}; _f \$@"
alias nvim="_f() {[[ -z \$@ ]] && {x=\$(FZF_DEFAULT_COMMAND='fd --type f' fzf);[[ \$? -eq 0 ]] && command nvim \$x || true} || { command nvim \$@ } }; _f $@"
alias rvim="x=\$(fzf --bind 'change:reload:rg --column --line-number --no-heading --color=always --smart-case {q} || true' --ansi --phony --query '');[[ \$? -eq 0 ]] && command nvim '\$(echo \$x|cut -d: -f1)' +':\$(echo $x| cut -d: -f2)' || true"
alias myip="dig +short myip.opendns.com @resolver1.opendns.com"

autoload -Uz compinit

if [[ $OS == "darwin" ]]; then
    if [ $(date +'%j') != $(/usr/bin/stat -f '%Sm' -t '%j' ${ZDOTDIR:-$HOME}/.zcompdump) ]; then
        compinit;
    else
        compinit -C;
    fi
fi

my_loader=$ZSH_CONFIG/autoloaded
fpath=(
    $my_loader
    $fpath
)
if [[ -d $my_loader ]]; then
    for func in $my_loader/*; do
        autoload -Uz ${func:t}
    done
fi
unset my_loader

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && . "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
